<rules category="architecture">
  <metadata>
    <trigger>always_on</trigger>
  </metadata>

  <rule severity="CRITICAL" enforcement="BLOCKING">
    <name>Local-First Architecture with Jazz Tools</name>
    <description>Spicy Golf is a local-first application using Jazz Tools for data sync. The app works offline and syncs when online. Most functionality must work without API calls.</description>
    <rationale>Users need to track golf games in areas with poor connectivity. Local-first ensures app works anywhere.</rationale>
    <mustAcknowledge>true</mustAcknowledge>
    <instructions>
      - Use Jazz CoMaps and CoLists for all data storage
      - Only call the API package for data that can't be stored locally
      - Assume the device may be offline at any time
      - Design features to work offline first, sync later
      - See jazz.xml for Jazz-specific patterns
    </instructions>
  </rule>

  <rule severity="CRITICAL" enforcement="BLOCKING">
    <name>Never Commit to Git Without Permission</name>
    <description>Never commit code to git or push commits to a remote without explicitly asking the user first.</description>
    <rationale>User must review and approve all changes before they are committed</rationale>
    <mustAcknowledge>true</mustAcknowledge>
    <instructions>
      Always ask before running git commit or git push commands.
    </instructions>
  </rule>

  <rule severity="HIGH" enforcement="STRICT">
    <name>Monorepo Structure</name>
    <description>This is a monorepo with packages for different components of the Spicy Golf app.</description>
    <packages>
      <package name="app">
        <description>React Native mobile application (main production app)</description>
        <tech>React Native, TypeScript, Jazz Tools, Unistyles</tech>
      </package>
      <package name="api">
        <description>Backend API for data that can't be stored locally</description>
        <tech>ElysiaJS, TypeScript</tech>
      </package>
      <package name="lib">
        <description>Shared utilities, types, and business logic</description>
        <tech>TypeScript</tech>
      </package>
    </packages>
    <instructions>
      When adding new code that could be reused across packages, place it in packages/lib. Never duplicate code between packages.
    </instructions>
  </rule>

  <rule severity="HIGH" enforcement="STRICT">
    <name>Minimize Code, Maximize Modularity</name>
    <description>Attempt to reduce the amount of code rather than add more. Prefer iteration and modularization over code duplication.</description>
    <instructions>
      - Look for existing code that can be reused or refactored
      - Break complex functionality into smaller, reusable modules
      - Delete dead code rather than commenting it out
      - Avoid adding new files when existing ones can be enhanced
    </instructions>
  </rule>

  <rule severity="MEDIUM" enforcement="RECOMMENDED">
    <name>No Unnecessary Comments</name>
    <description>Do not add comments unless explicitly told to do so, or the code is sufficiently complex that it requires comments.</description>
    <rationale>Code should be self-documenting. Comments often become stale and misleading.</rationale>
    <instructions>
      - Write clear, self-explanatory code instead of adding comments
      - Only add comments for complex algorithms or non-obvious business logic
      - Use meaningful variable and function names instead of comments
    </instructions>
  </rule>

  <rule severity="MEDIUM" enforcement="RECOMMENDED">
    <name>Testing Strategy</name>
    <description>Tests must be run in a React Native environment. Don't ask to run tests as they require special setup.</description>
    <instructions>
      When implementing features, consider testability but don't attempt to run tests yourself.
    </instructions>
  </rule>

  <rule severity="MEDIUM" enforcement="RECOMMENDED">
    <name>API Usage Minimization</name>
    <description>The app should call the API package sparingly, only for data that can't be stored locally or synced via Jazz.</description>
    <rationale>Local-first design means most functionality works offline</rationale>
    <instructions>
      Before adding an API call, verify that the data truly can't be handled locally with Jazz Tools.
    </instructions>
  </rule>
</rules>
